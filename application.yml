source_list:
  - SB
  - OL
  - CP
  - ADDR

SB:
  mysql_conf:
    dbtable: testdb.TRANSACTIONSYNC
    partition_column: App_Transaction_Id
    query: "(select * from testdb.TRANSACTIONSYNC where Internal_Member_Id = 'PC7135361') as t"

OL:
  sftp_conf:
    filetype: csv
    delimiter: |
    directory: /home/ubuntu/data

CP:
  s3_conf:
    s3_bucket: sureshboddu

ADDR:
  mongodb_config:
    database: customer
    collection: address


s3_conf:
  s3_bucket: sureshboddu
  staging_dir: pg_staging


REGIS_DIM:
  tableName: "DATAMART.REGIS_DIM"
  sourceData:
    - CP
    - ADDR
  loadingQuery: >
    SELECT
      '' AS REGIS_KEY, REGIS_CNSM_ID AS CNSM_ID,CAST(REGIS_CTY_CODE AS SMALLINT) AS CTY_CODE,
      CAST(REGIS_ID AS INTEGER) as REGIS_ID, REGIS_DATE, REGIS_LTY_ID AS LTY_ID, REGIS_CHANNEL, REGIS_GENDER, REGIS_CITY, INS_DT,
      city, state, street, ins_dt1
    FROM
     (SELECT
       DISTINCT a.REGIS_CNSM_ID, CAST(a.REGIS_CTY_CODE AS SMALLINT), CAST(a.REGIS_ID AS INTEGER),
       a.REGIS_LTY_ID, a.REGIS_DATE, a.REGIS_CHANNEL, a.REGIS_GENDER, a.REGIS_CITY, a.INS_DT,
       b.city, b.state, b.street, b.ins_dt as ins_dt1
      FROM
        CustomerPortal a join Address b
      ON a.REGIS_CNSM_ID = b.consumer_id
     ) CP